import{_ as w,T as S,c as d,f as r,a as i,w as s,n as D,d as _,F as m,e as a,o as c,r as U,b as k,t as f,g as T}from"./index.b66bf6c1.js";const B={components:{Tab:S},created(){let t=this.$route.query.action;this.action=t,this.CartData()},data(){return{action:"",checked:[],CartList:[],LoginUser:this.$cookies.get("LoginUser"),checkbox:!1}},computed:{total(){if(this.checked.length<=0)return 0;let t=0;for(let o of this.CartList)this.checked.includes(o.id)&&(t+=parseFloat(o.total));return t*100}},methods:{onClickLeft(){this.$router.go(-1)},async CartData(){let t=await this.$api.CartIndex({userid:this.LoginUser.id});t.code===1&&(this.CartList=t.data)},async onStepper(t){(await this.$api.CartStepper(t)).code===1&&this.CartData()},onCheck(){this.checked.length==this.CartList.length?this.checkbox=!0:this.checkbox=!1},onSubmit(){if(this.checked.length<=0)return this.$notify({type:"warning",message:"\u8BF7\u9009\u62E9\u5546\u54C1\u7ED3\u7B97"}),!1;let t=this.checked.join(",");this.$router.push({path:"/product/cart/confirm",query:{ids:t}})},onChecked(){this.checkbox?this.$refs.group.toggleAll(!0):this.$refs.group.toggleAll(!1)},onDel(t){this.$dialog.confirm({message:"\u786E\u5B9A\u5C06\u5546\u54C1\u79FB\u51FA\u8D2D\u7269\u8F66\uFF1F"}).then(async()=>{let o=await this.$api.CartDel(t);this.$toast(o.msg),location.reload()}).catch(()=>{})}}},N={key:0},q=["src"];function F(t,o,A,j,n,l){const h=a("van-nav-bar"),p=a("van-checkbox"),g=a("van-stepper"),C=a("van-card"),b=a("van-button"),v=a("van-swipe-cell"),x=a("van-empty"),y=a("van-checkbox-group"),L=a("van-submit-bar"),V=a("Tab");return c(),d(m,null,[n.action=="cart"?(c(),r(h,{key:0,title:"\u8D2D\u7269\u8F66","left-arrow":"",onClickLeft:l.onClickLeft},null,8,["onClickLeft"])):(c(),r(h,{key:1,title:"\u8D2D\u7269\u8F66"})),i(y,{modelValue:n.checked,"onUpdate:modelValue":o[0]||(o[0]=e=>n.checked=e),ref:"group"},{default:s(()=>[n.CartList.length>0?(c(),d("div",N,[(c(!0),d(m,null,U(n.CartList,e=>(c(),r(v,{key:e.id},{right:s(()=>[i(b,{square:"",text:"\u5220\u9664",type:"danger",class:"delete-button",onClick:u=>l.onDel({cartid:e.id})},null,8,["onClick"])]),default:s(()=>[i(C,{price:e.total,title:e.product.name,class:"goods-card"},{thumb:s(()=>[i(p,{name:e.id,class:"checkbox",onClick:l.onCheck},null,8,["name","onClick"]),k("img",{src:e.product.cover_cdn},null,8,q)]),num:s(()=>[i(g,{modelValue:e.nums,"onUpdate:modelValue":u=>e.nums=u,onChange:u=>l.onStepper({cartid:e.id,nums:e.nums})},null,8,["modelValue","onUpdate:modelValue","onChange"])]),desc:s(()=>[k("span",null,"\u5546\u54C1\u5355\u4EF7\uFF1A\uFFE5"+f(e.price),1)]),_:2},1032,["price","title"])]),_:2},1024))),128))])):(c(),r(x,{key:1,description:"\u8D2D\u7269\u8F66\u7A7A\u7A7A\u5982\u4E5F"}))]),_:1},8,["modelValue"]),n.CartList.length>0?(c(),r(L,{key:2,price:l.total,"button-text":"\u63D0\u4EA4\u8BA2\u5355",onSubmit:l.onSubmit,class:D(n.action?"":"bar")},{default:s(()=>[i(p,{modelValue:n.checkbox,"onUpdate:modelValue":o[1]||(o[1]=e=>n.checkbox=e),onClick:l.onChecked},{default:s(()=>[T(f(n.checkbox?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009"),1)]),_:1},8,["modelValue","onClick"])]),_:1},8,["price","onSubmit","class"])):_("",!0),n.action?_("",!0):(c(),r(V,{key:3}))],64)}const E=w(B,[["render",F]]);export{E as default};
